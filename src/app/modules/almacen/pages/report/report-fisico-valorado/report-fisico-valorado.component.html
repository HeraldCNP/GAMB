<div class="m-3">
  <div class="row">
    <div class="col-md-12">
      <div class="card shadow p-3 mb-3 bg-body rounded">
        <button *ngIf="!cargando" type="button" printTitle="."  [printStyle]="{ '@page': { size: 'landscape !important' } }"
        [useExistingCss]="true" printSectionId="content" ngxPrint
          class="btn btn-primary">
          Imprimir
        </button>
        <h3 class="text-center p-0">Reporte</h3>
        <div class="row animated fadeIn fast" *ngIf="cargando">
          <div class="col-md-12">
            <div class="alert alert-info text-center">
              <h4 class="alert-heading">Cargando</h4>
              <i class="fas fa-sync-alt fa-spin"></i><br />
              <span>Por favor espere</span>
            </div>
          </div>
        </div>
        <!-- {{ reportForm.value | json }} -->
        <div class="container" id="content" *ngIf="!cargando">
          <div class="d-flex justify-content-between ml-2 mb-0">
            <div class="p-2 ">
              <img src="/assets/img/logoGamb.png" alt="" width="175px" />
            </div>
            <div class="text-center ml-5 mt-3 mb-0">
              <h3 class="off-m">FISICO VALORADO</h3>
              <h4 class="off-m">Del 01 de Enero de 2023 AL 31 de Diciembre de 2023</h4>
              <p class="off-m">Expresado en Bolivianos</p>
            </div>
            <div class="p-3 ">
              <img src="/assets/img/sisal.png" alt="" width="163px" />
            </div>
          </div>
          <div>
            <table class="table-bordered mb-0 table-responsive">
              <thead>
                <!-- <tr *ngIf="user">
                  <th class="title" colspan="8">
                    REPORTE DE CORRESPONDENCIA - ESTADO: {{ this.estado }}
                    <br />
                    <i class="subtitle">Desde: {{ fechaIni | date : "longDate" : "UTC" }} Hasta:
                      {{ fechaHoy | date : "longDate" : "UTC" }}</i>
                    <br />
                    <i class="subtitle">FUNCIONARIO: {{ this.user.username }}
                      {{ this.user.surnames }} - {{ this.destino }}</i>
                  </th>
                </tr> -->
                <tr>
                  <th colspan="5"></th>
                  <th colspan="2">Saldos Iniciales</th>
                  <th colspan="2">Ingresos</th>
                  <th colspan="2">Egresos</th>
                  <th colspan="2">Saldos</th>
                </tr>
                <tr class="head">
                  <!-- <th>n</th> -->
                  <th>N°</th>
                  <th>N° Entrada</th>
                  <th style="width: 60px;">Código</th>
                  <th>Articulo</th>
                  <th>Unidad</th>
                  <th>Cantidad</th>
                  <th>Valor</th>
                  <th>Cantidad</th>
                  <th>Valor</th>
                  <th>Cantidad</th>
                  <th>Valor</th>
                  <th>Cantidad</th>
                  <th>Valor</th>
                </tr>
              </thead>
              <tbody>
                <ng-container *ngFor="let category of categories">
                  <tr *ngFor="let item of separados[category]; let i = index">
                    <!-- <td class="off-p"><pre>{{ item | json }}</pre></td> -->
                    <td>{{ i + 1 }}</td>
                    <td>{{ item.idEntrada.numeroEntrada }}</td>
                    <td class="off-p">{{ item.idArticulo.codigo }}</td>
                    <td>{{ item.idArticulo.nombre }}</td>
                    <td>{{ item.idArticulo.unidadDeMedida | titlecase }}</td>
                    <ng-container *ngIf="item.idEntrada.tipo === saldoInicial">
                      <td class="derecha">{{ item.cantidadCompra | number : '1.2-2' }}</td>
                      <td class="derecha">{{ item.cantidadCompra * item.precio | currency : "USD" : "" }}</td>
                    </ng-container>
                    <ng-container *ngIf="item.idEntrada.tipo != saldoInicial">
                      <td></td>
                      <td></td>
                    </ng-container>

                    <ng-container *ngIf="item.idEntrada.tipo != saldoInicial">
                      <td class="derecha">{{ item.cantidadCompra | number : '1.2-2' }}</td>
                      <td class="derecha">{{ item.cantidadCompra * item.precio | currency : "USD" : "" }}</td>
                    </ng-container>

                    <ng-container *ngIf="item.idEntrada.tipo == saldoInicial">
                      <td></td>
                      <td></td>
                    </ng-container>

                    <td class="derecha">{{ item.cantidadCompra - item.stockCompra | number : '1.2-2' }}</td>
                    <td class="derecha">{{ (item.cantidadCompra - item.stockCompra) * item.precio | currency : "USD" :
                      "" }}</td>
                    <td class="derecha">{{ item.stockCompra | number : '1.2-2' }}</td>
                    <td class="derecha">{{ item.stockCompra * item.precio | currency : "USD" : "" }}</td>
                    <!-- <td><span *ngIf="item.salidas.length > 0">{{ item.salidas[0].cantidadSalida }}</span></td> -->
                  </tr>
                  <tr>
                    <td class="off-p" colspan="5"><b> {{ nameCate[category] }} </b></td>
                    <td class="off-p" class="text-end off-p">
                      <b style="font-weight: bold">{{ cantidadSaldosIniciales[category] | currency : "USD" : "" }}</b>
                    </td>
                    <td class="off-p" class="text-end off-p">
                      <b style="font-weight: bold">{{ totalSaldosIniciales[category] | currency : "USD" : "" }}</b>
                    </td>
                    <td class="off-p" colspan="1" class="text-end off-p">
                      <b style="font-weight: bold">{{ cantidadIngresos[category] | number : "1.2-2" }}</b>
                    </td>
                    <td class="off-p" class="text-end off-p">
                      <b style="font-weight: bold">{{ totalIngresos2[category] | currency : "USD" : "" }}</b>
                    </td>
                    <td class="off-p" colspan="1" class="text-end off-p">
                      <b style="font-weight: bold">{{ cantidadEgresos[category] | number : "1.2-2" }}</b>
                    </td>
                    <td class="off-p" class="text-end off-p">
                      <b style="font-weight: bold">{{ totalEgresos[category] | currency : "USD" : "" }}</b>
                    </td>
                    <td class="off-p" class="text-end off-p">
                      <b style="font-weight: bold">{{ cantidadSaldos[category] | currency : "USD" : "" }}</b>
                    </td>
                    <td class="off-p" class="text-end off-p">
                      <b style="font-weight: bold">{{ totalSaldos[category] | currency : "USD" : "" }}</b>
                    </td>
                  </tr>
                </ng-container>
                <tr>
                  <ng-container>
                    {{ fullEgresos() }}
                  </ng-container>
                  <td colspan="5">

                  </td>
                  <td class="text-end off-p"><b>{{ sumaTotalCantidadSaldosIniciales | number : "1.2-2" }}</b></td>
                  <td class="text-end off-p"><b>{{ sumaTotalSaldosIniciales | number : "1.2-2" }}</b></td>
                  <td class="text-end off-p"><b>{{ sumaTotalCantidadIngresos | number : "1.2-2" }}</b></td>
                  <td class="text-end off-p"><b>{{ sumaTotalIngresos | number : "1.2-2" }}</b></td>
                  <td class="text-end off-p"><b>{{ sumaTotalEgresos | number : "1.2-2" }}</b></td>
                  <td class="text-end off-p"><b>{{ sumaTotalCantidadEgresos | number : "1.2-2" }}</b></td>
                  <td class="text-end off-p"><b>{{ sumaTotalCantidadSaldos | number : "1.2-2" }}</b></td>
                  <td class="text-end off-p"><b>{{ sumaTotalSaldos | number : "1.2-2" }}</b></td>
                </tr>
              </tbody>

            </table>

            <div class="mt-5 pt-5">
              <div class="d-flex justify-content-around ml-3 mb-0 mt-5 pt-5">

                <div class="">
                  <div class="text-center">
                    Responsable de Area <br />
                    Financiera
                  </div>
                </div>
                <div class="">
                  <div class="text-center">
                    Contador General
                  </div>
                </div>
                <div class="">
                  <div class="text-center">
                    Responsable de Almacen
                  </div>
                </div>
                <div class="">
                  <div class="text-center">
                    Maxima Autoridad Ejecutiva
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- <table class="table table-striped table-responsive" id="table">

  <thead>
    <tr *ngIf="user">
      <th class="title" colspan="8">REPORTE DE CORRESPONDENCIA - ESTADO: {{ this.estado }} <br> <i
          class="subtitle">Desde: {{ fechaIni | date:'longDate': 'UTC' }} Hasta: {{ fechaHoy |
          date:'longDate': 'UTC' }}</i> <br> <i class="subtitle">FUNCIONARIO: {{ this.user.username }} {{
          this.user.surnames }} - {{ this.destino }}</i> </th>

    </tr>
    <tr class="head">
      <th>N°</th>
      <th>Número</th>
      <th>Cat. Prog.</th>
      <th>Proveedor</th>
      <th>Cantidad</th>
      <th>Precio</th>
      <th>Stock</th>
      <th>total</th>
      <th>Estado</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let entrada of entradas; let i = index">
      <td>{{ i + 1 }}</td>
      <td>
        {{ entrada.idEntrada.numeroEntrada }}
      </td>
      <td>{{ entrada.catProgra }}</td>

      <td>{{ entrada.idEntrada.idProveedor.razon_social }}</td>
      <td>{{ entrada.cantidadCompra }}</td>
      <td>{{ entrada.precio }}</td>
      <td>{{ entrada.stockCompra }}</td>
      <td>{{ entrada.idArticulo.cantidad }} - {{ entrada.idArticulo.nombre }}</td>
      <td>{{ entrada.estadoCompra }}</td>


      <td [ngSwitch]="entrada.estado">
        <span *ngSwitchCase="'ENVIADO'" class="badge badge-danger">{{
          entrada.estado
          }}</span>
        <span *ngSwitchCase="'RECIBIDO'" class="badge badge-success">{{ entrada.estado }}
        </span>
        <span *ngSwitchCase="'DERIVADO'" class="badge badge-info">{{
          entrada.estado
          }}</span>
        <span *ngSwitchCase="'MALETIN'" class="badge badge-warning">{{ entrada.estado }}
        </span>
        <span *ngIf="
            entrada.estado != 'DERIVADO' &&
            entrada.estado != 'MALETIN' &&
            entrada.estado != 'RECIBIDO' &&
            entrada.estado != 'ENVIADO'
          " class="bg badge text-dark">{{ entrada.estado }}</span>
      </td>

      <td>

      </td>

    </tr>
  </tbody>
  <tfoot>
    <tr class="usuario">
      <td colspan="6">SISTEMA CONTROL Y SEGUIMIENDO DE HOJA DE RUTA - GAM BETANZOS</td>
      <td colspan="2">Usuario: {{ data.username }} {{ data.surnames }}</td>
    </tr>
  </tfoot>
</table> -->
